<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Seraph Browser</title>

<style>
body{
  margin:0;
  font-family:-apple-system,Segoe UI,Inter,sans-serif;
  background:#fff;color:#111;
  opacity:0;
  transition:opacity .3s ease;
}

/* TOP BAR */
.top{
  display:flex;
  align-items:center;
  gap:8px;
  padding:10px;
  border-bottom:1px solid #ddd;
  background:#fafafa;
}

input{
  flex:1;
  padding:8px 10px;
  border-radius:8px;
  border:1px solid #ccc;
}

button{
  padding:6px 10px;
  border-radius:8px;
  border:none;
  background:#111;
  color:#fff;
  cursor:pointer;
}

/* Tabs */
.tabs{
  display:flex;
  gap:6px;
  padding:6px;
  background:#f3f3f3;
  overflow-x:auto;
}
.tab{
  padding:4px 10px;
  background:#fff;
  border-radius:6px;
  cursor:pointer;
  white-space:nowrap;
}
.tab.active{background:#111;color:#fff;}

/* Frame */
iframe{
  width:100%;
  height:calc(100vh - 100px);
  border:none;
}

/* Left Switcher (same icons) */
.side-tabs{
  position:fixed;
  top:50%;
  left:20px;
  transform:translateY(-50%);
  background:#fff;
  border-radius:40px;
  box-shadow:0 8px 25px rgba(0,0,0,0.15);
  display:flex;
  flex-direction:column;
  padding:6px;
  gap:6px;
}
.tab-btn{
  width:44px;height:44px;border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  border:none;background:#fff;color:#111;cursor:pointer;
}
.tab-btn.active{background:#111;color:#fff;}

/* Seraph homepage */
.home{
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  height:calc(100vh - 100px);
  gap:16px;
}
.logo{
  font-size:42px;
  font-weight:600;
}
.quick{
  display:flex;
  gap:10px;
}
.quick button{
  background:#eee;color:#111;
}

/* Safe redirect button (customizable) */
.redirect{
  position:fixed;
  bottom:20px;
  right:20px;
  background:#ff3b30;
  color:#fff;
  border-radius:50%;
  width:70px;height:70px;
  font-weight:bold;
}
</style>
</head>
<body>

<!-- Left Switcher -->
<div class="side-tabs">
  <button class="tab-btn" onclick="navigate('/')">
    <!-- house icon -->
    <svg viewBox="0 0 24 24" width="20">
      <path fill="currentColor" d="M12 3l9 8h-3v9h-4v-6H10v6H6v-9H3z"/>
    </svg>
  </button>
  <button class="tab-btn active">
    <!-- globe icon -->
    <svg viewBox="0 0 24 24" width="20">
      <circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="2" fill="none"/>
      <path d="M3 12h18M12 3a15 15 0 010 18M12 3a15 15 0 000 18"
            stroke="currentColor" stroke-width="1.6" fill="none"/>
    </svg>
  </button>
</div>

<!-- TOP BAR -->
<div class="top">
  <button onclick="goBack()">←</button>
  <input id="url" placeholder="Search or enter URL">
  <button onclick="load()">Go</button>
  <button onclick="newTab()">＋</button>
  <button onclick="bookmark()">★</button>
  <button onclick="toggleFullscreen()">⛶</button>
</div>

<div class="tabs" id="tabs"></div>

<div id="view"></div>

<!-- Safe redirect button -->
<button class="redirect" onclick="location.href='https://example.com'">
SAFE
</button>

<script>
window.addEventListener("pageshow",()=>document.body.style.opacity=1);

const view=document.getElementById("view");
const tabsUI=document.getElementById("tabs");
let tabs=[];
let active=0;

function renderTabs(){
  tabsUI.innerHTML="";
  tabs.forEach((t,i)=>{
    const el=document.createElement("div");
    el.className="tab"+(i===active?" active":"");
    el.textContent=t.title||"New Tab";
    el.onclick=()=>switchTab(i);
    tabsUI.appendChild(el);
  });
}

function switchTab(i){
  active=i;
  showTab();
}

function showTab(){
  const tab=tabs[active];
  renderTabs();
  if(tab.home){
    view.innerHTML=homeHTML;
  }else{
    view.innerHTML=`<iframe src="${tab.url}"></iframe>`;
  }
}

function newTab(){
  tabs.push({home:true,title:"Home"});
  active=tabs.length-1;
  showTab();
}

function load(){
  let url=document.getElementById("url").value.trim();
  if(!url) return;
  if(!/^https?:\/\//i.test(url)) url="https://"+url;

  const proxy="/.netlify/functions/proxy?url="+encodeURIComponent(url);
  tabs[active]={url:proxy,title:url};
  saveHistory(url);
  showTab();
}

function goBack(){
  const iframe=document.querySelector("iframe");
  iframe?.contentWindow.history.back();
}

function bookmark(){
  const url=tabs[active].title;
  let b=JSON.parse(localStorage.getItem("bookmarks")||"[]");
  b.push(url);
  localStorage.setItem("bookmarks",JSON.stringify(b));
  alert("Bookmarked!");
}

function saveHistory(url){
  let h=JSON.parse(localStorage.getItem("history")||"[]");
  h.unshift(url);
  localStorage.setItem("history",JSON.stringify(h.slice(0,50)));
}

function toggleFullscreen(){
  if(!document.fullscreenElement) document.documentElement.requestFullscreen();
  else document.exitFullscreen();
}

function navigate(u){
  document.body.style.opacity=0;
  setTimeout(()=>location.href=u,300);
}

/* Seraph homepage */
const homeHTML=`
<div class="home">
  <div class="logo">Seraph</div>
  <input id="homeSearch" placeholder="Search the web"
         style="padding:12px;border-radius:10px;border:1px solid #ccc;width:320px;">
  <div class="quick">
    <button onclick="quick('https://google.com')">Google</button>
    <button onclick="quick('https://youtube.com')">YouTube</button>
    <button onclick="showBookmarks()">Bookmarks</button>
    <button onclick="showHistory()">History</button>
  </div>
</div>
`;

function quick(u){
  document.getElementById("url").value=u;
  load();
}

function showBookmarks(){
  const b=JSON.parse(localStorage.getItem("bookmarks")||"[]");
  alert("Bookmarks:\\n"+b.join("\\n"));
}
function showHistory(){
  const h=JSON.parse(localStorage.getItem("history")||"[]");
  alert("History:\\n"+h.join("\\n"));
}

/* Start with home tab */
newTab();
</script>
</body>
</html>
